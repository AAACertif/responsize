var f=this;function k(a,b){var c=a.split("."),d=f;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function n(){this.T=window.ce.api.CloudExplorer.get("ce-js");this.v=null}k("FileService",n);n.prototype.open=function(){var a=this;return new Promise(function(b,c){a.T.pick(function(c){console.log("my Blob: "+JSON.stringify(c));a.v=c;b(c.url)},function(a){console.log("error "+JSON.stringify(a));c(a)})})};n.prototype.open=n.prototype.open;
n.prototype.save=function(a){var b=this;return new Promise(function(c,d){console.log("fileService save",a,b.v);b.T.write(b.v,a,function(a){console.log("my Blob: "+JSON.stringify(a));b.v=a;c(a.url)},function(a){console.log("error "+JSON.stringify(a));d(a)})})};n.prototype.save=n.prototype.save;function q(){this.Y=30}
function r(a,b,c){c||(c=b.body);var d=[],e;for(e in c.childNodes)1===c.childNodes[e].nodeType&&d.push({w:c.childNodes[e],rect:c.childNodes[e].getBoundingClientRect()});e=d.length;var g=!1;do for(var g=!1,h=0;++h<e&&!1===g;){var s=d[h].w,w=d[h-1].w,l=d[h].rect,p=d[h-1].rect,y=p.top>l.top&&p.top<l.bottom||p.top<l.top&&p.bottom>l.top,t=p.left>l.right;if(p.top>l.bottom||y&&t)console.log("swap",l,p),c.insertBefore(s,w),g=d[h-1],d[h-1]=d[h],d[h]=g,g=!0}while(!0===g);for(var v in d)0<d[v].w.childNodes.length&&
r(a,b,d[v].w)}q.prototype.Z=function(a){var b=0,c;for(c in a.parentNode.childNodes)1===a.parentNode.childNodes[c].nodeType&&b++;return 1<b};function u(a,b){for(var c=x(b),d=1;12>=d;d++)a.classList.remove(c+d)}function x(a){var b="col-xs-";1200<=a?b="col-lg-":992<=a?b="col-md-":768<=a&&(b="col-sm-");return b};function z(a){this.element=a;this.a=a.getElementsByTagName("iframe")[0];this.height=this.width=1;this.R=!0;window.addEventListener("resize",this.e.bind(this))}k("Stage",z);z.prototype.ia=function(a,b){this.R=!1;this.width=a;this.height=b;this.e()};z.prototype.setSize=z.prototype.ia;z.prototype.F=function(){return{width:this.width,height:this.height}};z.prototype.getSize=z.prototype.F;
z.prototype.X=function(){for(var a=null,b=null,c=null,d=null,e=this.a.contentDocument.querySelectorAll("*"),g=0;g<e.length;g++){var h=e[g];if(null===a||h.offsetLeft<a)a=h.offsetLeft;if(null===c||h.offsetTop<c)c=h.offsetTop;h.offsetLeft+h.offsetWidth>b&&(b=h.offsetLeft+h.offsetWidth);h.offsetTop+h.offsetHeight>d&&(d=h.offsetTop+h.offsetHeight)}return{ua:b-a,oa:d-c}};z.prototype.getContentSize=z.prototype.X;
z.prototype.e=function(){if(this.R){var a=this.X();this.width=a.ua;this.height=a.oa}this.a.style.width=this.width+"px";this.a.style.height=this.height+"px";var a=this.element.offsetWidth,b=this.element.offsetHeight,c=Math.min(1,a/this.width,b/this.height);this.a.style.transform="scale("+c+")";this.a.style.transformOrigin="0 0";b=(b-this.height*c)/2;this.a.style.left=(a-this.width*c)/2+"px";this.a.style.top=b+"px"};z.prototype.redraw=z.prototype.e;
z.prototype.j=function(a){a?this.a.parentNode.classList.add("rsz-loading"):this.a.parentNode.classList.remove("rsz-loading")};z.prototype.setLoading=z.prototype.j;z.prototype.ja=function(a){var b=this;return new Promise(function(c,d){b.j(!0);b.a.onload=function(){b.j(!1);b.e();c(b.a.contentDocument)};b.a.onerror=function(a){b.j(!1);d(a)};b.a.src=a})};z.prototype.setUrl=z.prototype.ja;z.prototype.la=function(){return this.a.contentDocument.documentElement.outerHTML};z.prototype.getHtml=z.prototype.la;
z.prototype.ra=function(a){var b=this;return new Promise(function(c,d){b.j(!0);b.a.onload=function(){b.j(!1);""!==a&&(b.a.src="",b.a.contentDocument.write(a));b.e();c(b.a.contentDocument)};b.a.onerror=function(a){b.j(!1);d(a)};b.a.src="about:blank"})};z.prototype.setHtml=z.prototype.ra;k("Device",{wa:0,xa:1,ya:2,za:3,va:4});var A=[{name:"mobile",width:320,height:480},{name:"mobile-h",width:476,height:320},{name:"tablet",width:769,height:1024},{name:"tablet-h",width:1024,height:769},{name:"desktop",width:1920,height:1080}];k("DeviceData",A);
function B(a){var b=this;this.element=a;this.element.querySelector(".open");this.ea=this.element.querySelector(".save");this.S=this.element.querySelector(".clear-formatting");this.selection=[];this.K=this.H=this.q=this.k=null;this.element.addEventListener("click",function(a){return C(b,a)})}k("Toolbar",B);function D(a,b){b?a.ea.classList.remove("off"):a.ea.classList.add("off")}
function C(a,b){var c=b.target;c.classList.contains("open")&&a.k&&a.k();c.classList.contains("save")&&a.q&&a.q();c.classList.contains("clear-formatting")?a.H&&a.selection.forEach(function(b){return a.H(b)}):c.classList.contains("mobile")?a.i(0):c.classList.contains("mobile-h")?a.i(1):c.classList.contains("tablet")?a.i(2):c.classList.contains("tablet-h")?a.i(3):c.classList.contains("desktop")&&a.i(4);b.preventDefault();return!1}
B.prototype.i=function(a){for(var b=this.element.querySelectorAll(".selected"),c=0;c<b.length;c++)b.item(c).classList.remove("selected");this.element.querySelector("."+A[a].name).classList.add("selected");this.K&&this.K(A[a].width,A[a].height)};B.prototype.setDevice=B.prototype.i;B.prototype.M=function(a){this.selection=a;this.e()};B.prototype.setSelection=B.prototype.M;B.prototype.e=function(){this.selection&&0<this.selection.length?this.S.classList.remove("off"):this.S.classList.add("off")};
B.prototype.redraw=B.prototype.e;function E(){this.O=[];this.pa=0}k("RszDom",E);function F(a,b){a.O.forEach(function(a){a=b.querySelector("#"+a.id);a.parentNode.removeChild(a)});for(var c=b.querySelectorAll(".rsz-select-candidate, .rsz-selected"),d=0;d<c.length;d++)c[d].classList.remove("rsz-selected"),c[d].classList.remove("rsz-select-candidate")}function G(a,b){a.O.forEach(function(a){return b.querySelector("head").appendChild(a.cloneNode(!0))})}E.prototype.C=function(a,b){b.id="rsz-"+this.pa++;this.O.push(b);a&&a.head.appendChild(b.cloneNode(!0))};
E.prototype.addTempElement=E.prototype.C;function H(){this.g=null;this.d=this.A=!1}k("RszSelection",H);H.prototype.reset=function(a){this.A=!1;I(this,a)};H.prototype.n=function(){this.A=!0;return!1};H.prototype.o=function(a,b){if(this.A)this.d||(this.d=!0);else{for(var c=a.querySelectorAll(".rsz-select-candidate"),d=0;d<c.length;d++)c[d].classList.remove("rsz-select-candidate");b.classList.add("rsz-select-candidate")}return!1};
H.prototype.p=function(a,b,c,d,e){this.A=!1;if(this.d)this.d=!1;else return e||this.f(a).forEach(function(a){a!=b&&J(a)}),this.select(b),!0;return!1};H.prototype.f=function(a){if(a){a=a.querySelectorAll(".rsz-selected");for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b}return[]};H.prototype.getSelected=H.prototype.f;H.prototype.select=function(a,b){a.classList.contains("rsz-selected")||(a.classList.add("rsz-selected"),!1!==b&&this.g&&this.g())};
function J(a){a.classList.contains("rsz-selected")&&a.classList.remove("rsz-selected")}function I(a,b){a.f(b).forEach(function(a){J(a)})};function Q(){this.u=5;this.g=null;this.d=!1;this.b=null;this.D=-1}k("RszResize",Q);Q.prototype.n=function(a,b,c,d){a=b.getBoundingClientRect();this.D=R(this,a,c,d);this.b=-1!==this.D?b:null;return!1};
Q.prototype.o=function(a,b,c,d,e,g){switch(R(this,b.getBoundingClientRect(),c,d)){case 1:case 3:a.body.classList.add("rsz-resize-ew");break;case 0:case 2:a.body.classList.add("rsz-resize-ns");break;case -1:a.body.classList.remove("rsz-resize-ew"),a.body.classList.remove("rsz-resize-ns")}if(null!==this.b){this.d||(this.d=!0);a=this.b.getBoundingClientRect();a={left:a.left,right:a.right,top:a.top,bottom:a.bottom};switch(this.D){case 1:a.left=c;break;case 3:a.right=c;break;case 0:a.top=d;break;case 2:a.bottom=
d}c=a;g&&(c=g(this.b,c));g=this.b.parentNode.getBoundingClientRect();c&&(this.b.style.left=c.left-g.left+"px",this.b.style.top=c.top-g.top+"px",this.b.style.width=c.right-c.left+"px",this.b.style.height=c.bottom-c.top+"px");return!0}return!1};Q.prototype.p=function(){return this.b&&this.d?(this.d=!1,this.b=null,this.g&&this.g(this.b),!0):!1};
function R(a,b,c,d){c-=b.left;d-=b.top;var e=b.right-b.left;b=b.bottom-b.top;var g=-1;c<a.u&&0<c&&d<b&&0<d?g=1:c<e&&c>e-a.u&&d<b&&0<d?g=3:d<a.u&&0<d&&c<e&&0<c?g=0:d<b&&d>b-a.u&&c<e&&0<c&&(g=2);return g};function S(){this.V=this.t=this.document=this.I=this.J=null;this.aa=this.n.bind(this);this.ca=this.p.bind(this);this.ba=this.o.bind(this);this.da=this.preventDefault.bind(this);this.h=new H;this.L=new Q;this.r=this.l=!1;this.s=new E}k("Wysiwyg",S);S.prototype.sa=function(a){return this.h.g=a};S.prototype.setOnSelect=S.prototype.sa;S.prototype.ma=function(){return this.h.g};S.prototype.getOnSelect=S.prototype.ma;S.prototype.ta=function(a){return this.t=a};S.prototype.setSelectFilter=S.prototype.ta;
S.prototype.na=function(){return this.t};S.prototype.getSelectFilter=S.prototype.na;S.prototype.W=function(){var a=this.document.documentElement.cloneNode(!0);F(this.s,a);return a.outerHTML};S.prototype.getCleanHtml=S.prototype.W;
S.prototype.fa=function(a){this.document&&(this.document.removeEventListener("mousedown",this.aa),this.document.removeEventListener("mouseup",this.ca),this.document.removeEventListener("mousemove",this.ba),this.document.removeEventListener("click",this.da,!0),F(this.s,this.document.documentElement));this.h.reset(this.document);this.document=a;this.N(this.l);this.document.addEventListener("mouseup",this.ca,!0);this.document.addEventListener("mousedown",this.aa);this.document.addEventListener("mousemove",
this.ba);this.document.addEventListener("click",this.da,!0);G(this.s,this.document.documentElement)};S.prototype.setDocument=S.prototype.fa;S.prototype.N=function(a){this.l=a};S.prototype.setSelectionMode=S.prototype.N;S.prototype.ha=function(a){this.r=a};S.prototype.setResizeMode=S.prototype.ha;S.prototype.m=function(a){for(var b=a;b&&this.t&&!this.t(b);)b=b.parentNode;return b||a};S.prototype.getBestElement=S.prototype.m;
S.prototype.Q=function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);this.s.C(this.document,b)};S.prototype.addTempStyle=S.prototype.Q;S.prototype.ka=function(a){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",a);this.s.C(this.document,b)};S.prototype.addTempScript=S.prototype.ka;S.prototype.preventDefault=function(a){if(this.l||this.r)a.stopPropagation(),a.preventDefault()};
S.prototype.p=function(a){if(this.document){var b=this.m(a.target);this.l&&this.h.p(this.document,this.m(a.target),a.clientX,a.clientY,a.shiftKey)&&this.J&&this.J();this.r&&(a=this.L.p(this.document,b,a.clientX,a.clientY,a.shiftKey),this.I&&a&&this.I())}};S.prototype.n=function(a){if(this.document){var b=this.m(a.target);this.l&&this.h.n(this.document,b,a.clientX,a.clientY,a.shiftKey);this.r&&this.L.n(this.document,b,a.clientX,a.clientY,a.shiftKey)}};
S.prototype.o=function(a){if(this.document){var b=!1,c=this.m(a.target);this.l&&(b=b||this.h.o(this.document,c,a.clientX,a.clientY,a.shiftKey));this.r&&(b=b||this.L.o(this.document,c,a.clientX,a.clientY,a.shiftKey,this.V));b&&this.preventDefault(a)}};S.prototype.f=function(){return this.h.f(this.document)};S.prototype.getSelected=S.prototype.f;function T(a){var b=this;this.toolbar=new B(a.querySelector("#toolbar"));this.B=new z(a.querySelector("#stage"));this.c=new S;this.qa=new q;this.U=new n;this.toolbar.K=function(a,d){return b.B.ia(a,d)};this.toolbar.k=function(){return b.U.open().then(function(a){return b.k(a)})};this.toolbar.H=function(a){return u(a,b.B.F().width)};this.toolbar.q=function(){return b.U.save(b.c.W()).then(function(){return b.q()})};this.c.t=function(a){return b.$(a)};this.c.J=function(){b.toolbar.M(b.c.f());D(b.toolbar,
!0)};this.c.V=function(a,d){D(b.toolbar,!0);var e=d.right-d.left,g=b.B.F().width,h=a.parentNode.getBoundingClientRect(),e=Math.max(1,Math.round(e/Math.round((h.right-h.left)/12))),e=Math.min(12,e);u(a,g);a.classList.add(x(g)+e);return null};this.c.I=function(){};this.c.N(!0);this.c.ha(!0);this.toolbar.i(4);this.c.Q(window.location.href+"iframe.css")}
T.prototype.Z=function(a){if(a&&a.parentNode&&a.parentNode.childNodes){var b=0,c;for(c in a.parentNode.childNodes)1===a.parentNode.childNodes[c].nodeType&&b++;return 1<b}return!1};k("App.prototype.hasSiblings",T.prototype.Z);T.prototype.$=function(a){return a&&a.parentNode&&a.parentNode.classList&&a.parentNode.classList.contains("row")};k("App.prototype.isBootstrapCol",T.prototype.$);
T.prototype.k=function(a){var b=this;this.B.ja(a).then(function(a){var d=b.qa;if(a.querySelector("meta[content~=Silex]")){r(d,a);var e=a.querySelector("head style#responsize-style");console.log("importSilex",e);null===e&&(e=a.createElement("style"),e.innerHTML='        @media (max-width: 1024px) {          .bg{            opacity: 1 !important;          }          body, .container .editable-style{            position: relative;            max-width: 100%;            top: auto;            left: auto;            height: auto;            top: initial;            left: initial;            height: initial;            padding: 0;          }          .container .editable-style::before{            content: "\\00A0";          }          .container .editable-style .silex-element-content{            height: auto !important;            height: initial !important;          }          body {            width: 100% !important;          }        }      ',
e.id="responsize-style",a.head.appendChild(e))}null===a.querySelector("link[href*=bootstrap]")&&(console.log("addBootstrapImports add style"),e=a.createElement("link"),e.rel="stylesheet",e.href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css",e.media="(max-width: 1024px)",a.head.appendChild(e));null===a.querySelector("script[src*=bootstrap]")&&(console.log("addBootstrapImports add script"),e=a.createElement("script"),e.src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js",
a.head.appendChild(e));a.body.classList.add("container");e=a.body.querySelectorAll(".container-element");console.log("addBootstrapContainer",e);for(var g=0;g<e.length;g++)e[g].classList.add("row");e=a.body.querySelectorAll(".row");console.log("addBootstrapCols",e);for(g=0;g<e.length;g++){for(var h=e[g],s=h.getBoundingClientRect(),w=s.left-d.Y,l=Math.round((s.right-s.left-2*d.Y)/12),s=[],p=0;p<h.childNodes.length;p++){var y=h.childNodes[p];if(1===y.nodeType){var t=y.getBoundingClientRect(),v=t.left-
w,t=Math.max(1,Math.round((t.right-t.left)/l)),t=Math.min(12,t),v=Math.max(0,Math.round(v/l)),v=Math.min(11,v);s.push({element:y,P:t,G:v})}}l=w=h=0;try{for(var U in s){var m=s[U],K=m.P,L=Math.min(12,2*m.P),M=Math.min(12,4*m.P);m.element.classList.add("col-md-"+K);m.element.classList.add("col-sm-"+L);m.element.classList.add("col-xs-"+M);var N=Math.max(0,Math.min(11,m.G-h%12)),O=Math.max(0,Math.min(11,Math.round((m.G-w%12)/2))),P=Math.max(0,Math.min(11,Math.round((m.G-l%12)/4)));m.element.classList.add("col-md-offset-"+
N);m.element.classList.add("col-sm-offset-"+O);m.element.classList.add("col-xs-offset-"+P);h+=K+N;w+=L+O;l+=M+P}}catch(V){console.log("Error",V)}}b.c.fa(a);b.toolbar.M([])})};T.prototype.q=function(){D(this.toolbar,!1)};window.initResponsizeApp=function(){var a=new T(document.getElementById("rsz-app")),b=W();b.url&&setTimeout(function(){return a.k(b.url)},1E3)};window.onerror=function(a,b,c){window.ga("send","Uncaught error",a,b,c);return!0};function W(){for(var a=document.location.search,a=a.split("+").join(" "),b={},c,d=/[?&]?([^=]+)=([^&]*)/g;c=d.exec(a);)b[decodeURIComponent(c[1])]=decodeURIComponent(c[2]);return b};
//# sourceMappingURL=/responsize.js.map