var c=this;function f(a,b){var d=a.split("."),e=c;d[0]in e||!e.execScript||e.execScript("var "+d[0]);for(var k;d.length&&(k=d.shift());)d.length||void 0===b?e=e[k]?e[k]:e[k]={}:e[k]=b};function g(){this.G=window.ce.api.CloudExplorer.get("ce-js")}f("FileService",g);g.prototype.open=function(){var a=this;return new Promise(function(b,d){a.G.pick(function(a){console.log("my Blob: "+JSON.stringify(a));b(a)},function(a){console.log("error "+JSON.stringify(a));d(a)})})};g.prototype.open=g.prototype.open;function h(a){this.element=a;this.b=a.getElementsByTagName("iframe")[0];this.height=this.width=1;window.addEventListener("resize",this.d.bind(this))}f("Stage",h);h.prototype.B=function(a,b){console.log("setSize",a,b);this.width=a;this.height=b;this.d()};h.prototype.setSize=h.prototype.B;
h.prototype.d=function(){this.b.style.width=this.width+"px";this.b.style.height=this.height+"px";var a={F:this.element.offsetWidth,q:this.element.offsetHeight};console.log("redraw",a,this.b);var b=Math.min(1,a.F/this.width,a.q/this.height);this.b.style.transform="scale("+b+")";this.b.style.transformOrigin="0 0";var d=(a.q-this.height*b)/2;this.b.style.left=(a.F-this.width*b)/2+"px";this.b.style.top=d+"px"};h.prototype.redraw=h.prototype.d;
h.prototype.C=function(a){var b=this;return new Promise(function(d,e){b.b.onload=function(){return d(b.b.contentDocument)};b.b.onerror=function(a){return e(a)};b.b.src=a})};h.prototype.setUrl=h.prototype.C;f("Device",{R:0,S:1,T:2,U:3,Q:4});var l=[{name:"mobile",width:320,height:480},{name:"mobile-h",width:476,height:320},{name:"tablet",width:768,height:1024},{name:"tablet-h",width:1024,height:768},{name:"desktop",width:1280,height:800}];f("DeviceData",l);
function m(a){var b=this;this.element=a;this.s=this.element.querySelector(".move-element");this.element.querySelector(".open");this.N=this.element.querySelector(".save");this.selection=[];this.n=this.w=this.m=null;this.element.addEventListener("click",function(a){var e=a.target;e.classList.contains("open")&&b.m&&b.m();e.classList.contains("save")?(b.N.classList.toggle("off"),b.w&&b.w()):e.classList.contains("mobile")?b.e(0):e.classList.contains("mobile-h")?b.e(1):e.classList.contains("tablet")?b.e(2):
e.classList.contains("desktop")&&b.e(4);a.preventDefault();return!1})}f("Toolbar",m);m.prototype.e=function(a){for(var b=this.element.querySelectorAll(".selected"),d=0;d<b.length;d++)b.item(d).classList.remove("selected");this.element.querySelector("."+l[a].name).classList.add("selected");this.n&&this.n(l[a].width,l[a].height)};m.prototype.setDevice=m.prototype.e;m.prototype.o=function(a){this.selection=a;this.d()};m.prototype.setSelection=m.prototype.o;
m.prototype.d=function(){this.selection&&0<this.selection.length?this.s.classList.remove("disabled"):this.s.classList.add("disabled")};m.prototype.redraw=m.prototype.d;function n(){this.j=this.i=this.k=!1;this.f=this.c=this.a=null;this.t=this.K.bind(this);this.v=this.M.bind(this);this.u=this.L.bind(this)}f("Wysiwyg",n);n.prototype.P=function(a){return this.c=a};n.prototype.setOnSelect=n.prototype.P;n.prototype.J=function(){return this.c};n.prototype.getOnSelect=n.prototype.J;n.prototype.O=function(a){return this.f=a};n.prototype.setOnBeforeSelect=n.prototype.O;n.prototype.I=function(){return this.f};n.prototype.getOnBeforeSelect=n.prototype.I;
n.prototype.A=function(a){this.a&&(this.a.removeEventListener("mousedown",this.t),this.a.removeEventListener("mouseup",this.v),this.a.removeEventListener("mousemove",this.u));this.a=a;this.p(this.k);this.a.addEventListener("mouseup",this.v);this.a.addEventListener("mousedown",this.t);this.a.addEventListener("mousemove",this.u);this.i=!1;a=document.createElement("style");a.innerHTML="      .rsz-select-mode * {        min-width: 20px !important;        min-height: 20px !important;        opacity: 1 !important;        box-shadow: 0px 0px 2px rgba(51, 51, 51, 0.2);        cursor: pointer;      }      .rsz-dragging {        position: absolute !important;      }      .rsz-selected {        box-shadow: 0 0 4px #333333;      }      .rsz-select-candidate {      }    ";
this.a.appendChild(a)};n.prototype.setContainer=n.prototype.A;n.prototype.p=function(a){this.k=a;this.a&&(a?this.a.classList.add("rsz-select-mode"):this.a.classList.remove("rsz-select-mode"))};n.prototype.setSelectionMode=n.prototype.p;n.prototype.h=function(a){for(var b=a;b&&this.f&&!this.f(b);)b=b.parentNode;return b||a};n.prototype.getBestElement=n.prototype.h;n.prototype.M=function(a){p(this,this.h(a.target));a.preventDefault();return!1};
n.prototype.K=function(a){this.h(a.target);this.i=!0;a.preventDefault();return!1};n.prototype.L=function(a){var b=this.h(a.target);if(this.k)if(this.i)this.j||(this.j=!0);else{for(var d=this.a.querySelectorAll(".rsz-select-candidate"),e=0;e<d.length;e++)d[e].classList.remove("rsz-select-candidate");b.classList.add("rsz-select-candidate")}a.preventDefault();return!1};
function p(a,b){a.i=!1;a.k&&(a.j?a.j=!1:(a.l().forEach(function(d){d!=b&&(d.classList.remove("rsz-selected"),a.c&&a.c())}),q(a,b)))}n.prototype.l=function(){for(var a=[],b=this.a.querySelectorAll(".rsz-selected"),d=0;d<b.length;d++)a.push(b[d]);return a};n.prototype.getSelected=n.prototype.l;n.prototype.select=function(a){a.classList.add("rsz-selected");this.c&&this.c()};function q(a,b){b.classList.toggle("rsz-selected");a.c&&a.c()};function r(a){var b=this;this.toolbar=new m(a.querySelector("#toolbar"));this.D=new h(a.querySelector("#stage"));this.g=new n;this.H=new g;this.toolbar.n=function(a,e){return b.D.B(a,e)};this.toolbar.m=function(){return b.H.open().then(function(a){return s(b,a)})};this.g.f=function(a){return b.r(a)};this.g.c=function(){return b.toolbar.o(b.g.l())};this.g.p(!0);this.toolbar.e(4)}
r.prototype.r=function(a){var b=0,d;for(d in a.parentNode.childNodes)1===a.parentNode.childNodes[d].nodeType&&b++;return 1<b};f("App.prototype.hasSiblings",r.prototype.r);function s(a,b){a.D.C(b.url).then(function(b){a.g.A(b.body);a.toolbar.o([])})};window.initResponsizeApp=function(){new r(document.getElementById("rsz-app"))};
